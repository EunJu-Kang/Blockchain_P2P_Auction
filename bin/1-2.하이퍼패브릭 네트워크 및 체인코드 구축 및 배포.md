처음 킴

```
sudo passwd root
//초기 root 비밀번호 설정!
```

```
sudo apt update
sudo apt install apt-transport-https
sudo apt install ca-certificates
sudo apt install curl
sudo apt install software-properties-common
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - 
sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable"
sudo apt update
apt-cache policy docker-ce
sudo apt install docker-ce

sudo systemctl status docker
//도커 버전확인

도커 컴포즈 다운로드
sudo curl -L "https://github.com/docker/compose/releases/download/1.24.1/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose

//Docker Compose가 위치한 /usr/local/bin/docker-compose 경로에 실행 권한을 추가
sudo chmod +x /usr/local/bin/docker-compose

컴퓨터에 Aution폴더 복붙
폴더로 이동

sudo docker-compose -f zookeeper-compose.yaml up -d
sudo docker-compose -f kafka-compose.yaml up -d
///////////////////

//권한주기 
chmod 777 configtxgen 

//채널 생성
./configtxgen -profile AuctionOrdererGenesis -outputBlock orderer-genesis.block -channelID ordererchannel001

./configtxgen -profile AuctionChannel -outputCreateChannelTx auctionchannel001.tx -channelID auctionchannel001

//생성된 트랜잭션 파일이동
mv auctionchannel001.tx ./channel-artifacts

//Orderer 실행
sudo docker-compose -f orderer-compose.yaml up -d

//Peer 실행
vi peer-compose.yaml 입력후
----> CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE 확인후
peer-compose.yaml이 속해있는 폴더이름_defalut로 변경 (반드시 소문자) -2군데있음

sudo docker-compose -f peer-compose.yaml up -d

//채널생성
sudo docker exec -e "CORE_PEER_LOCALMSPID=copyrightAssociateOrgMSP" -e "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/users/msp" peer0.copyrightOrg peer channel create -o orderer001:7050 -c auctionchannel001 -f /var/hyperledger/production/auctionchannel001.tx --outputBlock /var/hyperledger/production/auctionchannel001-genesis.block

//채널 참여
sudo docker exec -e "CORE_PEER_LOCALMSPID=copyrightAssociateOrgMSP" -e "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/users/msp" peer0.copyrightOrg peer channel fetch config /var/hyperledger/production/auctionchannel001-genesis.block -o orderer001:7050 -c auctionchannel001

sudo docker exec -e "CORE_PEER_LOCALMSPID=copyrightAssociateOrgMSP" -e "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/users/msp" peer0.copyrightOrg peer channel join -o orderer001:7050 -b /var/hyperledger/production/auctionchannel001-genesis.block

sudo docker exec -e "CORE_PEER_LOCALMSPIP=digitalAuthorOrgMSP" -e "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/users/msp" peer0.digitalAuthorOrg peer channel fetch config /var/hyperledger/production/auctionchannel001-genesis.block -o orderer001:7050 -c auctionchannel001

sudo docker exec -e "CORE_PEER_LOCALMSPID=digitalAuthorOrgMSP" -e "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/users/msp" peer0.digitalAuthorOrg peer channel join -o orderer001:7050 -b /var/hyperledger/production/auctionchannel001-genesis.block

# create anchor peer update tx
앵커피어 업데이트 트랜잭션 생성
./configtxgen -profile AuctionChannel -outputAnchorPeersUpdate copyrightOrgAnchor.tx -channelID auctionchannel001 -asOrg copyrightAssociateOrgMSP

./configtxgen -profile AuctionChannel -outputAnchorPeersUpdate digitalAuthorOrgAnchor.tx -channelID auctionchannel001 -asOrg digitalAuthorOrgMSP

앵커피어 업데이트 트랜잭션 이동
mv copyrightOrgAnchor.tx ./channel-artifacts
mv digitalAuthorOrgAnchor.tx ./channel-artifacts

# update anchor peer
앵커 피어 업데이트
sudo docker exec -e "CORE_PEER_LOCALMSPID=copyrightAssociateOrgMSP" -e "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/users/msp" peer0.copyrightOrg peer channel update -o orderer001:7050 -c auctionchannel001 -f /var/hyperledger/production/copyrightOrgAnchor.tx

sudo docker exec -e "CORE_PEER_LOCALMSPID=digitalAuthorOrgMSP" -e "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/users/msp" peer0.digitalAuthorOrg peer channel update -o orderer001:7050 -c auctionchannel001 -f /var/hyperledger/production/digitalAuthorOrgAnchor.tx




 ===========
# 체인코드 
# ===========
# nodejs chaincode install
# 구동 확인을 위해 스켈레톤 체인코드가 아닌 완성본을 설치
sudo docker exec -e "CORE_PEER_LOCALMSPID=copyrightAssociateOrgMSP" -e "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/users/msp" peer0.copyrightOrg peer chaincode install -n asset -v 0.1 -l node -p /var/hyperledger/chaincode/node

sudo docker exec -e "CORE_PEER_LOCALMSPID=digitalAuthorOrgMSP" -e "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/users/msp" peer0.digitalAuthorOrg peer chaincode install -n asset -v 0.1 -l node -p /var/hyperledger/chaincode/node

# nodejs chaincode instantiate
# 체인코드 도커 컨테이너를 생성 및 구동
sudo docker exec -e "CORE_PEER_LOCALMSPID=digitalAuthorOrgMSP" -e "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/users/msp" peer0.digitalAuthorOrg peer chaincode instantiate -o orderer001:7050 -C auctionchannel001 -n asset -v 0.1 -c '{"Args":["init"]}' -P "OR('copyrightAssociateOrgMSP.member','digitalAuthorOrgMSP.member')"

# nodejs chaincode invoke
# 생성된 체인코드 동작 테스트
sudo docker exec -e "CORE_PEER_LOCALMSPID=digitalAuthorOrgMSP" -e "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/users/msp" peer0.digitalAuthorOrg peer chaincode invoke -o orderer001:7050 -C auctionchannel001 -n asset -c '{"Args":["registerAsset","testasset","testowner"]}'

# nodejs chaincode query
# 생성된 체인코드에 쿼리를 날려 invoke 시 등록한 정보가 반환되면 정상동작
sudo docker exec -e "CORE_PEER_LOCALMSPID=digitalAuthorOrgMSP" -e "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/users/msp" peer0.digitalAuthorOrg peer chaincode query -o orderer001:7050 -C auctionchannel001 -n asset -c '{"Args":["query","testasset"]}'



하리보 벡엔드에서 
properties 수정후
//CA배포
sudo docker-compose -f ./certificate-authority/ca-compose.yaml up -d



```

